\documentclass{article}
\usepackage{amsmath}
\begin{document}
    \paragraph*{Roll, pitch control input to Euler roll, pitch angles}
    Interpret roll and pitch inputs in range $[-1,1]*angle\_max$ to be angles of deflection of the body-frame Z axis from vertical.
    The projection of the Z axis onto the XY plane has y component $-sin(\gamma)$ and x component $sin(\beta)$ where
    $\gamma$ is the roll angle and $\beta$ is the pitch angle.
    The resultant body-frame Z vector is $\widehat{z}'$.  Now solve for the Euler roll and pitch angles which represent rotation of $\widehat{z}$ to $\widehat{z}'$:
    \[
    \begin{aligned}
        R_{y}R_{x}\widehat{z}&=
        \begin{bmatrix}
        c\beta  & 0 & s\beta  \\
        0 & 1 & 0 \\
        -s\beta  & 0 & c\beta 
        \end{bmatrix}
        \begin{bmatrix}
        1 & 0 & 0 \\
        0 & c\gamma & -s\gamma  \\
        0 & s\gamma & c\gamma 
        \end{bmatrix}
        \begin{bmatrix}
        0 \\
        0 \\
        1
        \end{bmatrix}\\
        &=
        \begin{bmatrix}
        s\beta \ c\gamma  \\
        -s\gamma  &  \\
        c\beta \ c\gamma 
        \end{bmatrix} \\
        &= \widehat{z}' \\
        s\beta \ c\gamma &= \widehat{z}'_x  \\
        -s\gamma &= \widehat{z}'_y \\
        \gamma &= -asin(\widehat{z}'_y) \\
        \beta &= asin(\widehat{z}'_x / cos(\gamma))
    \end{aligned}
    \]
\end{document}
